#pragma checksum "E:\HireHub\Views\Chat\Index.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "318bb8cf263216c8fcd87f1ea15a41fcee77b7fa"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Chat_Index), @"mvc.1.0.view", @"/Views/Chat/Index.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "E:\HireHub\Views\_ViewImports.cshtml"
using PlacementManagementSystem;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "E:\HireHub\Views\_ViewImports.cshtml"
using PlacementManagementSystem.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "E:\HireHub\Views\_ViewImports.cshtml"
using PlacementManagementSystem.ViewModels;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"318bb8cf263216c8fcd87f1ea15a41fcee77b7fa", @"/Views/Chat/Index.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"b21cb94dcacddf1b491f359b07476742891efc91", @"/Views/_ViewImports.cshtml")]
    public class Views_Chat_Index : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<List<PlacementManagementSystem.ViewModels.ChatMessageViewModel>>
    {
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_0 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("id", new global::Microsoft.AspNetCore.Html.HtmlString("messageForm"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_1 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("class", new global::Microsoft.AspNetCore.Html.HtmlString("d-flex"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Microsoft.AspNetCore.Mvc.TagHelpers.FormTagHelper __Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper;
        private global::Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper __Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 2 "E:\HireHub\Views\Chat\Index.cshtml"
  
    ViewData["Title"] = "Student Chat";

#line default
#line hidden
#nullable disable
            WriteLiteral(@"
<div class=""container-fluid"">
    <div class=""row"">
        <div class=""col-12"">
    <div class=""d-flex justify-content-between align-items-center mb-3"">
        <h2 class=""mb-0"">Student Chat</h2>
        <div class=""d-flex align-items-center"">
            <div class=""text-muted"">
                <i class=""fas fa-university""></i> College Students Only
            </div>
        </div>
    </div>
            
");
#nullable restore
#line 18 "E:\HireHub\Views\Chat\Index.cshtml"
             if (ViewBag.ErrorMessage != null)
            {

#line default
#line hidden
#nullable disable
            WriteLiteral("                <div class=\"alert alert-warning\" role=\"alert\">\r\n                    <i class=\"fas fa-exclamation-triangle\"></i> ");
#nullable restore
#line 21 "E:\HireHub\Views\Chat\Index.cshtml"
                                                           Write(ViewBag.ErrorMessage);

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n                </div>\r\n");
#nullable restore
#line 23 "E:\HireHub\Views\Chat\Index.cshtml"
            }

#line default
#line hidden
#nullable disable
            WriteLiteral(@"        </div>
    </div>
    
    <div class=""row"">
        <div class=""col-12"">
            <div class=""card shadow-sm"">
                <div class=""card-body p-0"">
                    <!-- Chat Messages Area -->
                    <div id=""chatMessages"" class=""chat-messages"" style=""height: 500px; overflow-y: auto; padding: 20px;"">
");
#nullable restore
#line 33 "E:\HireHub\Views\Chat\Index.cshtml"
                         if (Model != null)
                        {
                            

#line default
#line hidden
#nullable disable
#nullable restore
#line 35 "E:\HireHub\Views\Chat\Index.cshtml"
                             foreach (var msg in Model)
                            {

#line default
#line hidden
#nullable disable
            WriteLiteral("                                <div");
            BeginWriteAttribute("class", " class=\"", 1341, "\"", 1410, 2);
            WriteAttributeValue("", 1349, "message", 1349, 7, true);
#nullable restore
#line 37 "E:\HireHub\Views\Chat\Index.cshtml"
WriteAttributeValue(" ", 1356, msg.IsOwnMessage ? "own-message" : "other-message", 1357, 53, false);

#line default
#line hidden
#nullable disable
            EndWriteAttribute();
            WriteLiteral(" data-message-id=\"");
#nullable restore
#line 37 "E:\HireHub\Views\Chat\Index.cshtml"
                                                                                                                       Write(msg.Id);

#line default
#line hidden
#nullable disable
            WriteLiteral("\">\r\n                                    <div class=\"message-header\">\r\n                                        <strong class=\"sender-name\">");
#nullable restore
#line 39 "E:\HireHub\Views\Chat\Index.cshtml"
                                                               Write(msg.SenderName);

#line default
#line hidden
#nullable disable
            WriteLiteral("</strong>\r\n                                        <small class=\"text-muted\">");
#nullable restore
#line 40 "E:\HireHub\Views\Chat\Index.cshtml"
                                                             Write(msg.SentAt.ToLocalTime().ToString("g"));

#line default
#line hidden
#nullable disable
            WriteLiteral("</small>\r\n");
#nullable restore
#line 41 "E:\HireHub\Views\Chat\Index.cshtml"
                                         if (msg.IsOwnMessage)
                                        {

#line default
#line hidden
#nullable disable
            WriteLiteral("                                            <button class=\"btn btn-sm btn-outline-danger delete-message\" data-message-id=\"");
#nullable restore
#line 43 "E:\HireHub\Views\Chat\Index.cshtml"
                                                                                                                     Write(msg.Id);

#line default
#line hidden
#nullable disable
            WriteLiteral("\" title=\"Delete message\">\r\n                                                <i class=\"fas fa-trash\"></i>\r\n                                            </button>\r\n");
#nullable restore
#line 46 "E:\HireHub\Views\Chat\Index.cshtml"
                                        }

#line default
#line hidden
#nullable disable
            WriteLiteral("                                    </div>\r\n                                    <div class=\"message-content\">");
#nullable restore
#line 48 "E:\HireHub\Views\Chat\Index.cshtml"
                                                            Write(msg.Message);

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\r\n                                </div>\r\n");
#nullable restore
#line 50 "E:\HireHub\Views\Chat\Index.cshtml"
                            }

#line default
#line hidden
#nullable disable
#nullable restore
#line 50 "E:\HireHub\Views\Chat\Index.cshtml"
                             
                        }

#line default
#line hidden
#nullable disable
            WriteLiteral("                    </div>\r\n                    \r\n                    <!-- Message Input Area -->\r\n                    <div class=\"message-input-area p-3 border-top\">\r\n                        ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("form", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "318bb8cf263216c8fcd87f1ea15a41fcee77b7fa9675", async() => {
                WriteLiteral(@"
                            <input type=""text"" id=""messageInput"" class=""form-control"" placeholder=""Type your message..."" maxlength=""1000"" required>
                            <button type=""submit"" class=""btn btn-primary ml-2"">
                                <i class=""fas fa-paper-plane""></i> Send
                            </button>
                        ");
            }
            );
            __Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.FormTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper);
            __Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_0);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_1);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral(@"
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .chat-messages {
        background-color: #f8f9fa;
        display: flex;
        flex-direction: column;
    }
    
    .message {
        margin-bottom: 15px;
        padding: 10px;
        border-radius: 10px;
        max-width: 70%;
        display: flex;
        flex-direction: column;
        word-wrap: break-word;
    }
    
    .own-message {
        background-color: #007bff;
        color: white;
        margin-left: auto;
        align-self: flex-end;
    }
    
    .other-message {
        background-color: white;
        border: 1px solid #dee2e6;
        align-self: flex-start;
    }
    
    .message-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
        padding-bottom: 4px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .othe");
            WriteLiteral(@"r-message .message-header {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    .sender-name {
        font-size: 0.9em;
        font-weight: 600;
    }
    
    .message-content {
        word-wrap: break-word;
        white-space: pre-wrap;
        margin-top: 4px;
        line-height: 1.4;
    }
    
    .text-muted {
        font-size: 0.8em;
        margin-left: 8px;
    }
    
    .delete-message {
        padding: 2px 6px;
        font-size: 0.7em;
    }
    
    .message-input-area {
        background-color: white;
    }
    
    #messageInput {
        border-radius: 20px;
        border: 1px solid #ced4da;
    }
    
    #messageInput:focus {
        border-color: #007bff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }
</style>

");
            DefineSection("Scripts", async() => {
                WriteLiteral(@"
    <script src=""https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/6.0.1/signalr.min.js""></script>
    <script>
        const connection = new signalR.HubConnectionBuilder()
            .withUrl(""/chathub"")
            .build();

        const currentUserId = '");
#nullable restore
#line 156 "E:\HireHub\Views\Chat\Index.cshtml"
                          Write(ViewBag.CurrentUserId);

#line default
#line hidden
#nullable disable
                WriteLiteral(@"';
        const chatMessages = document.getElementById('chatMessages');
        const messageForm = document.getElementById('messageForm');
        const messageInput = document.getElementById('messageInput');

        // Scroll to bottom of chat
        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Add message to chat
        function addMessage(message) {
            const messageDiv = document.createElement('div');
            const isOwnMessage = message.senderUserId === currentUserId;
            
            messageDiv.className = `message ${isOwnMessage ? 'own-message' : 'other-message'}`;
            messageDiv.setAttribute('data-message-id', message.id);
            
            const sentAt = new Date(message.sentAt);
            
            messageDiv.innerHTML = `
                <div class=""message-header"">
                    <strong class=""sender-name"">${message.senderName}</strong>
                    ");
                WriteLiteral(@"<small class=""text-muted"">${sentAt.toLocaleString()}</small>
                    ${isOwnMessage ? `<button class=""btn btn-sm btn-outline-danger delete-message"" data-message-id=""${message.id}"" title=""Delete message"">
                        <i class=""fas fa-trash""></i>
                    </button>` : ''}
                </div>
                <div class=""message-content"">${message.message}</div>
            `;
            
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        // Remove message from chat
        function removeMessage(messageId) {
            const messageElement = document.querySelector(`[data-message-id=""${messageId}""]`);
            if (messageElement) {
                messageElement.remove();
            }
        }

        // Clear chat history on page load to ensure fresh start
        function clearChatHistory() {
            const messagesContainer = document.getElementById('messages');
            if (messagesContai");
                WriteLiteral(@"ner) {
                messagesContainer.innerHTML = '';
            }
        }

        // Clear chat history when page loads
        clearChatHistory();

        // Start SignalR connection
        connection.start().then(function () {
            console.log(""Connected to chat hub"");
            connection.invoke(""JoinChat"");
        }).catch(function (err) {
            console.error(""Error connecting to chat hub: "" + err.toString());
        });

        // Handle receiving messages
        connection.on(""ReceiveMessage"", function (message) {
            addMessage(message);
        });


        // Handle message deletion
        connection.on(""MessageDeleted"", function (messageId) {
            removeMessage(messageId);
        });

        // Handle errors
        connection.on(""Error"", function (error) {
            alert(""Error: "" + error);
        });

        // Handle form submission only if form exists
        if (messageForm) {
            messageForm.addEvent");
                WriteLiteral(@"Listener('submit', function (e) {
                e.preventDefault();
                const message = messageInput.value.trim();
                if (message) {
                    connection.invoke(""SendMessage"", message).catch(function (err) {
                        console.error(""Error sending message: "" + err.toString());
                    });
                    messageInput.value = '';
                }
            });
        }

        // Handle Enter key (send) vs Shift+Enter (new line) only if input exists
        if (messageInput) {
            messageInput.addEventListener('keydown', function (e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    if (messageForm) {
                        messageForm.dispatchEvent(new Event('submit'));
                    }
                }
            });
        }

        // Handle delete message buttons
        document.addEventListener('click', function (e) {
     ");
                WriteLiteral(@"       if (e.target.closest('.delete-message')) {
                const messageId = e.target.closest('.delete-message').getAttribute('data-message-id');
                if (confirm('Are you sure you want to delete this message?')) {
                    connection.invoke(""DeleteMessage"", parseInt(messageId)).catch(function (err) {
                        console.error(""Error deleting message: "" + err.toString());
                    });
                }
            }
        });

        // Scroll to bottom on page load
        window.addEventListener('load', function () {
            scrollToBottom();
        });
    </script>
");
            }
            );
            WriteLiteral("\r\n");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<List<PlacementManagementSystem.ViewModels.ChatMessageViewModel>> Html { get; private set; }
    }
}
#pragma warning restore 1591
